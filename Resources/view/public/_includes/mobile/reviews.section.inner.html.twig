{% set params = {
    'limit': app.request.get('limit'),
    'category': app.request.get('category'),
    'url': app.request.get('url'),
    'page': reviews.next
} %}

<div>
    {% for review in reviews.data %}
        <div class=" {{ loop.last == true ? '' : 'border-bottom' }} py-3">
            <div class="d-flex align-items-center gap-1 mb-3">

                {% set rating = review.reviewRatingValue|round %}
                {% for i in 1..5 %}
                    <svg xmlns="http://www.w3.org/2000/svg" width="12" height="12"
                         fill="{% if i > rating and review.reviewRatingValue is not null %} #d1d1d1 {% else %} #ffc107 {% endif %}" class="bi bi-star-fill"
                         viewBox="0 0 16 16">
                        <path d="M3.612 15.443c-.386.198-.824-.149-.746-.592l.83-4.73L.173 6.765c-.329-.314-.158-.888.283-.95l4.898-.696L7.538.792c.197-.39.73-.39.927 0l2.184 4.327 4.898.696c.441.062.612.636.282.95l-3.522 3.356.83 4.73c.078.443-.36.79-.746.592L8 13.187l-4.389 2.256z"></path>
                    </svg>
                {% endfor %}
            </div>

            <h3 class="fs-14 fw-bold mb-2">
                {{ review.reviewName ?: 'Анонимный пользователь' }}
            </h3>

            <p class="fs-12 text-truncate">
                {#{{ review.reviewText|length > 150 ? review.reviewText|striptags|slice(0, 150) ~ '...' : review.reviewText|striptags }}#}
                {{ review.reviewText|striptags }}
            </p>

            {% if review.reviewText|length > 150 %}
                <a class="d-flex  align-items-center mb-2 fw-bold text-black btn-collapsed collapsed" data-bs-toggle="collapse"
                   href="#collapseRead{{ loop.index }}" role="button" aria-expanded="false" aria-controls="collapseRead{{ loop.index }}">
                    <span class="me-2 fs-11">Читать полностью</span>
                    <svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" fill="currentColor"
                         class="bi bi-chevron-up btn-collapsed-icon" viewBox="0 0 16 16">
                        <path fill-rule="evenodd"
                              d="M7.646 4.646a.5.5 0 0 1 .708 0l6 6a.5.5 0 0 1-.708.708L8 5.707l-5.646 5.647a.5.5 0 0 1-.708-.708l6-6z"></path>
                    </svg>
                </a>


                <div class="collapse" id="collapseRead{{ loop.index }}">
                    <p class=" fs-12 mb-2">
                        {{ review.reviewText|striptags|nl2br }}
                    </p>
                </div>
            {% endif %}

            <span class="fs-12 text-secondary">
    {{ review.update|format_datetime(pattern="EEEE, d MMMM") }}
    </span>

        </div>


    {% endfor %}
</div>

{% if reviews.counter > reviews.data|length %}
    <button
            id="moreReviews"
            href="{{ path(reviews.path, params) }}"
            class='btn btn-primary'
            hx-get="{{ path(reviews.path, params) }}"
            hx-target="#moreReviews"
            hx-swap="outerHTML">
        Показать ещё...
    </button>
{% endif %}